language: python
python: '3.7'
branches:
  only:
  - master
  - develop

install:
  - pip install pytest coverage codacy-coverage
  - pip install -r requirements.txt

script:
  - coverage run -m py.test tests -vvv
  - coverage xml

deploy:
  provider: pypi
  username: "__token__"
  password:
    secure: "txFRI+rYjqLXHypyZsFAeqrS2x9tVdyYM5K+8H7iIc0cpA4iHB7l1cPVYWf/tGysIy/VZ9DAxPlJQEWiIk0c8JxJUZhoTmSTetLQCR6WjXgm/U7lF8Wy5LxTp3sFLC6l23FXrjXIkPqHCV2GVhUPYeDb73R8ZhVf3dTF7/+wNTq6Z5jSYXHsEA0Cah9Lna39cRF1oB4YNnu7t8eG6+oS5g/zcTxB7xA7htHwJ23ubsO2+i8rOY0EP+tJyOhasvpjkpyT1AXcQgwBorzjxpfMuCNFpbLYWPsF/qO8RUmoLzVWK3juBOJvlHDq/iJ3Yi4bO21RvLv2HZlZfD3GXonqXdkmiIwdV6V/zZ8e3jumjQdlZ7fWnC0JXr3VvWmRzdBzbZwetKJPiFP6VWzR/IK/h7UzN/m+FbzZk71qL71ueucWM6JN9EcloTP0IGI5wxi/oS3h1sCOLJbCAdjJ1pnQv07cQ2TjpOnsRnwsbULL/+Me731oCRg1R7IkSCx02fsatkSqgaHTVRqEKpT2x5Tot2z8UND6KxulPcYem8AtgwBFKBanqjAdr4NXdcbo7NuAh0MWTIXytyc9Ol/SKCmQrF3cKrA4lIPXwkEZx/CH3lAwRhdTb1osIzXlbj1K5aN9/x+aXzTewZLzSsIxxruCfJfxP084/WxWZP9kNDq5i/o="
  distributions: sdist bdist_wheel
  on:
    all_branches: true
  cleanup: false

after_script:
  - echo "Deploy to PyPI finished."